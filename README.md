Области хранения данных:

- Бд на Json server
- BFF ( Backend For Frontend)
- Redux Store (Состояние приложения)

Сущности приложения:

- пользователь: БД, (список), BFF (ссесия текущего пользователя), store (отображение в браузере)

-роль пользователя: БД, (Список ролей), BFF (Ссесия пользователя с ролью), store (Отображать / использовать роль
пользователя в приложении)

- Статья: БД (Список статей), стор (Отображение в браузере)
- Комментарии: Бд (список комментариев), стор (отображение в браузере)

Таблицы БД:

- пользователи - users: id / login / name / password / registed_at / role_id
- роли - roles: id / name
- статьи - posts: id / title / image_url / content / published_at
- Комментарии - commetns: id / author_id / post_id / content / published_at

Схема состояния на BFF:

- сессия текущего пользователя: login / password / role

Схема для Redux store (клиент):

- user: id / login / roleId
- posts: массив post: id / title / imageUrl / publishedAt / commentsCount
- post: id / title / imageUrl / content / publishedAt / comments: массив comment: id / author / content / publishedAt
- users: массив user: id / login / registeredAt / role

# Блог веб-разработчика

Полнофункциональное SPA-приложение — блог с системой авторизации, ролевой моделью доступа (RBAC), CRUD-операциями над статьями и комментариями, а также панелью администрирования пользователей.

Проект выполнен в рамках курса по Frontend-разработке от **Result University**.

---

## Демонстрация

> Для запуска проекта необходимо склонировать репозиторий и запустить локально (см. раздел «Запуск»).

---

## Стек технологий

| Категория | Технологии |
|---|---|
| **UI-библиотека** | React 19 (функциональные компоненты, хуки) |
| **Сборщик** | Vite 7 |
| **Управление состоянием** | Redux 5 + Redux Thunk |
| **Маршрутизация** | React Router 7 (`createBrowserRouter`) |
| **Стилизация** | styled-components 6 (CSS-in-JS) |
| **Формы и валидация** | React Hook Form + Yup |
| **API / Бэкенд** | json-server (имитация REST API) |
| **Иконки** | Font Awesome (локальные шрифты) |
| **Проверка типов пропсов** | prop-types |
| **Линтинг** | ESLint 9 (flat config) |

---

## Функциональность

### Публичная часть
- **Лента статей** — пагинированный список карточек (изображение, заголовок, дата, количество комментариев)
- **Поиск** — поиск статей по заголовку с debounce (задержка 2 сек)
- **Просмотр статьи** — полная статья с изображением, контентом и секцией комментариев
- **Регистрация и авторизация** — формы с валидацией (минимальная/максимальная длина, паттерны)

### Для авторизованных пользователей (Reader, Moderator, Admin)
- **Комментирование** — добавление комментариев к статьям

### Для модератора (Moderator) и администратора (Admin)
- **Удаление комментариев** — с диалогом подтверждения

### Для администратора (Admin)
- **Создание статей** — форма с полями заголовка, URL изображения и contentEditable-редактором контента
- **Редактирование статей** — инлайн-редактирование существующих статей
- **Удаление статей** — каскадное удаление вместе со всеми комментариями
- **Управление пользователями** — просмотр списка, изменение роли, удаление пользователей

---

## Архитектура

### Структура проекта

```
src/
├── Blog.jsx                    # Корневой layout (Header + Outlet + Footer + Modal)
├── main.jsx                    # Точка входа приложения
├── rourter.jsx                 # Конфигурация маршрутов
├── store.js                    # Redux store (combineReducers + thunk)
│
├── actions/                    # Action creators (sync + async thunks)
├── reducers/                   # Redux reducers (app, user, post, posts, users)
├── selectors/                  # Селекторы для чтения из store
│
├── bff/                        # Backend For Frontend — слой абстракции
│   ├── api/                    # Прямые fetch-запросы к json-server
│   ├── operations/             # Бизнес-логика + проверка доступа
│   ├── transformers/           # Маппинг данных БД → модель приложения
│   ├── sessions.js             # Управление сессиями
│   ├── constants/              # Роли, ошибки, лимиты пагинации
│   └── utils/                  # Утилиты (дата, подсчёт комментариев)
│
├── components/                 # Переиспользуемые UI-компоненты
├── hooks/                      # Кастомные хуки (useServerRequest, useResetForm)
├── pages/                      # Страницы приложения
│   ├── Main/                   # Главная (лента + поиск + пагинация)
│   ├── Post/                   # Просмотр / создание / редактирование статьи
│   ├── Authorization.jsx       # Страница входа
│   ├── Registration.jsx        # Страница регистрации
│   └── Users.jsx               # Управление пользователями (Admin)
│
└── utils/                      # Утилита checkAccess
```

### Трёхуровневая архитектура BFF

```
React-компоненты
       ↓  useServerRequest() — кастомный хук
BFF Operations (бизнес-логика + контроль доступа по сессии)
       ↓
BFF API (fetch-запросы)
       ↓
json-server (REST API, данные в db.json)
```

Слой BFF инкапсулирует всю логику работы с данными: валидацию сессий, проверку ролей, трансформацию данных из формата БД в формат приложения. Компоненты React не знают о структуре БД и работают только через операции BFF.

### Маршрутизация

| Маршрут | Страница | Доступ |
|---|---|---|
| `/` | Лента статей (Main) | Все |
| `/login` | Авторизация | Гость |
| `/register` | Регистрация | Гость |
| `/posts/:id` | Просмотр статьи | Все |
| `/posts/new` | Создание статьи | Admin |
| `/posts/:id/edit` | Редактирование статьи | Admin |
| `/users` | Управление пользователями | Admin |

### Ролевая модель (RBAC)

| Действие | Admin | Moderator | Reader | Guest |
|---|---|---|---|---|
| Просмотр статей и комментариев | + | + | + | + |
| Добавление комментария | + | + | + | - |
| Удаление комментария | + | + | - | - |
| Создание / редактирование / удаление статьи | + | - | - | - |
| Управление пользователями | + | - | - | - |

Контроль доступа реализован на **двух уровнях**:
1. **Клиент** — компонент `PrivateContent` и утилита `checkAccess` скрывают недоступные элементы UI
2. **Сервер (BFF)** — каждая защищённая операция проверяет сессию и роль через `sessions.access()`

### Управление состоянием (Redux)

```
store
├── app          # Модальное окно (isOpen, text, onConfirm, onCancel), флаг wasLogout
├── user         # Текущий пользователь (id, login, roleId, session)
├── post         # Текущая статья с комментариями
├── posts        # (зарезервировано)
└── users        # (зарезервировано)
```

Асинхронные операции реализованы через **Redux Thunk**: загрузка статьи, сохранение, удаление, добавление и удаление комментариев.

---

## Модель данных

### Таблицы БД (json-server)

| Таблица | Поля |
|---|---|
| **users** | `id`, `login`, `password`, `registed_at`, `role_id` |
| **roles** | `id`, `name` (Admin, Reader, Guest, Moderator) |
| **posts** | `id`, `title`, `image_url`, `content`, `published_at` |
| **comments** | `id`, `author_id`, `post_id`, `user_login`, `content`, `published_at` |
| **sessions** | `id`, `hash`, `user` (объект с данными пользователя) |

### Трансформация данных (БД → Приложение)

- `image_url` → `imageUrl`
- `published_at` → `publishedAt`
- `role_id` → `roleId`
- `post_id` → `postId`
- `author_id` → `authorId`
- `user_login` → `userLogin`

---

## Запуск проекта

### Предварительные требования
- Node.js 18+
- npm

### Установка и запуск

```bash
# Клонирование репозитория
git clone <url-репозитория>
cd authorBlogResult

# Установка зависимостей
npm install

# Запуск json-server (имитация бэкенда) — в отдельном терминале
npx json-server src/db.json --port 3000

# Запуск dev-сервера
npm run dev
```

Приложение будет доступно по адресу `http://localhost:5173`

### Сборка для продакшена

```bash
npm run build
npm run preview
```

---

## Ключевые технические решения

- **BFF-паттерн** — выделенный слой абстракции между React и json-server, обеспечивающий единообразную работу с данными и серверную валидацию доступа
- **Двухуровневый контроль доступа** — клиентский (скрытие UI) + серверный (проверка сессии в каждой операции)
- **Сессионная аутентификация** — хеш сессии хранится в `sessionStorage` и передаётся в каждый защищённый запрос
- **Кастомный хук `useServerRequest`** — автоматически подставляет хеш сессии в защищённые операции, абстрагируя компоненты от деталей авторизации
- **Модальное окно через Redux** — глобальный диалог подтверждения, управляемый через dispatch (open/close)
- **Debounce-поиск** — поиск по заголовкам с задержкой 2 секунды для снижения нагрузки на API
- **React Hook Form + Yup** — декларативная валидация форм авторизации и регистрации
- **styled-components** — вся стилизация через CSS-in-JS, компонентный подход к стилям
- **Пагинация** — серверная пагинация с навигацией (первая / предыдущая / текущая / следующая / последняя страница)

---

## Навыки, продемонстрированные в проекте

- Проектирование архитектуры SPA-приложения
- Работа с React 19 (функциональные компоненты, хуки, `forwardRef`)
- Управление глобальным состоянием через Redux (actions, reducers, selectors, thunks)
- Клиентская маршрутизация с React Router 7
- Реализация аутентификации и авторизации с ролевой моделью
- Паттерн Backend For Frontend (BFF)
- Работа с REST API (json-server)
- Валидация форм (React Hook Form + Yup)
- CSS-in-JS стилизация (styled-components)
- Компонентная архитектура с переиспользуемыми UI-элементами
